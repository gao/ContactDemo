<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Contact App Demo</title>
		<link rel="stylesheet" type="text/css" href="css/main.css" />
		<link rel="stylesheet" type="text/css" href="css/dialog.css" />
		<link rel="stylesheet" type="text/css" href="css/ico.css" />
		<link rel="stylesheet" type="text/css" href="css/form.css" />
		<link rel="stylesheet" type="text/css" href="css/mainScreen.css" />
		<link rel="stylesheet" type="text/css" href="css/contact.css" />
		<link rel="stylesheet" type="text/css" href="css/group.css" />
		<link rel="stylesheet" type="text/css" href="css/selectGroup.css" />

		<script type="text/javascript" src="js/jquery.js" ></script>
		<script type="text/javascript" src="js/jquery.tmpl.js" ></script>		
		<script type="text/javascript" src="js/snow.core.js" ></script>
		<script type="text/javascript" src="js/snow.dm.js" ></script>
		
		<!-- this is for mock data provider 
		<script type="text/javascript" src="js/ctd-mockDatas.js" ></script>
		<script type="text/javascript" src="js/ctd-dao-mockContact.js" ></script>
		<script type="text/javascript" src="js/ctd-dao-mockGroup.js" ></script>
		<script type="text/javascript" src="js/ctd-dao-mockGroupContact.js" ></script>
		<script type="text/javascript" src="js/ctd-daos-mock.js" ></script>
		-->

		<!-- this is for google data provider -->
		<script type="text/javascript" src="js/ctd-dao-googleContact.js" ></script>
		<script type="text/javascript" src="js/ctd-dao-googleGroup.js" ></script>
		<script type="text/javascript" src="js/ctd-daos-gdata.js" ></script>
		
		
    </head>
    <body>
    	<div>
			<img src="image.jpg" style="position:absolute; top: -1000px;">
	        <h2 style="padding:5px 0 5px 0;">
	        	snow.ui contacts demo
				<div id="login" class="login" style="display:none;float:right">
					<span class="button btnOk" onclick="login();"><span class="text">Login</span></span>
				</div>
	
				<div id="logout" class="logout" style="display:none;float:right">
					<span class="button btnOk" onclick="logout();"><span class="text">Logout</span></span>
				</div>
			</h2>
	
				<div id="container">
				</div>	
			
			
		</div> 

		<script type="text/javascript">
			function login() {
				if (dataProviderType == "googleData") {
					chrome.extension.getBackgroundPage().getToken(function(){
						chrome.extension.getViews()[1].snow.ui.display('mainScreen');
						$("#logout").show();
						$("#login").hide();
					});
				}else if (dataProviderType == "mockData") {
					localStorage.setItem("oauth_tokenMock","mockToken");
					$("#logout").show();
					$("#login").hide();
				}
			};
			function logout() {
				if (dataProviderType == "googleData") {
					chrome.extension.getBackgroundPage().logout();
				}
				else if (dataProviderType == "mockData") {
					localStorage.removeItem("oauth_tokenMock");
				}
				$("#login").show();
				$("#logout").hide();
			};
			
		</script>
		<script>
			$(document).ready(function(){

				if(dataProviderType == "mockData"){
					if(localStorage.getItem("oauth_tokenMock")){
						$("#logout").show();
						$("#login").hide();
					}else{
						$("#login").show();
						$("#logout").hide();
					}
					localStorage.setItem("groups",JSON.stringify(mockGroupDatas));
					localStorage.setItem("contacts",JSON.stringify(mockContactDatas));
				}else if(dataProviderType == "googleData"){
					var hasToken = chrome.extension.getBackgroundPage().oauth.hasToken();
					if(hasToken){
						$("#logout").show();
						$("#login").hide();
						chrome.extension.getBackgroundPage().getData(function(){
							chrome.extension.getViews()[1].snow.ui.display('mainScreen');
						});
					}else{
						$("#login").show();
						$("#logout").hide();
					}
				}
				
				snow.ui.display('mainScreen');

			});
		</script>
    </body>
</html>