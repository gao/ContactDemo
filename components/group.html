<!-- Simple groupsComponent -->
<script type="text/javascript">

	snow.ui.registerComponent("group",
		{
			parent: "#groupList",
			emptyParent: true
		},
		{
		build: function(data){
			var groups = snow.dm.find("group",{});
			var $group = null;
			$group = $("#groupListTmpl").tmpl({"groups":groups});
		
			return $group
		}
	});

	
	function deleteGroup(id){
		snow.dm.remove("group",id);
		var groupContacts = snow.dm.find("groupcontact",{});
		for(var i=0;i<groupContacts.length;i++){
			var o = groupContacts[i];
			if(id == o.groupId){
				snow.dm.remove("groupcontact",o.id);
			}
		}
		snow.ui.display("group");
		snow.ui.display('contact');
	}


</script>
<!--  /Simple groupsComponent -->



<script id="groupListTmpl" type="text/html">
	<div class="panel">
		<div class="panel-header">
			<button class="action" onclick="snow.ui.display('dialogGroup',{})">Create Group</button>
			<h1>Groups</h1>
		</div>

		<div class="panel-content">
			<ul>
				<li data-obj_type="group">
					<span class="name"><a class="edit" onclick="snow.ui.display('contact')">(All Groups)</a></span>
				</li>
				{{each groups}}
					<li data-obj_type="group" data-obj.id="${id}">
						<span class="name"><a class="edit" onclick="snow.ui.display('contact',{groupId:'${id}'})">${name}</a></span>
						<span class="del" onclick="deleteGroup('${id}')" >Del</span>
						<span class="del"  onclick="snow.ui.display('dialogGroup',{id:'${id}'})" >Edit&nbsp;</span>
					</li>	
				{{/each groups}}
			</ul>
		</div>
	
	</div>
</script>

