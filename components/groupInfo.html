<!-- groupInfo Component -->
<script type="text/javascript">

	snow.ui.registerComponent("groupInfo",
		{
			parent: "#trdCol",
			emptyParent:true
		},
		{
		build: function(data){
			var group = {};
			if(data && data.id){
				var groupId  = data.id;
				group = snow.dm.get("group",groupId);
			}
			var $e = $("#tmpl-groupInfo").tmpl(group);
			return $e;
		},
		postDisplay:function(){
			var thisComponent = this;
			var $element = this.$element;
			var id = $element.find(".main-content .groupInfo[data-obj_id]").attr("data-obj_id");
			$element.find(".btnEdit").click(function(){
				snow.ui.display("groupForm",{id:id});
			});
			$element.find(".btnDeleteGroup").click(function(){
				deleteGroup(id);
				snow.ui.display("groupInfo");
				snow.ui.display("group");
			});
			//helper functions
			function deleteGroup(id){
				snow.dm.remove("group",id);
				var groupContacts = snow.dm.find("groupcontact",{});
				for(var i=0;i<groupContacts.length;i++){
					var o = groupContacts[i];
					if(id == o.groupId){
						snow.dm.remove("groupcontact",o.id);
					}
				}
			}
		}
	});
	
</script>
<!--  /groupInfo Component -->

<script id="tmpl-groupInfo" type="text/html">
	<div class="main">
		<div class="main-header">
			<span class="button btnEdit"><span class="ico icoEdit"></span><span class="text">Edit</span></span>
			<span class="button btnGroup disable"><span class="ico icoGroup"></span><span class="text">Group</span><span class="ico icoDown"></span></span>
			<span class="button btnDeleteGroup del"><span class="ico icoDel"></span><span class="text">Delete Group</span></span>
		</div>
		<div class="main-content">
			<div class="groupInfo" data-obj_id="${id}">
				<p class="name" >${name}</p>
			</div>
		</div>
	</div>
</script>

